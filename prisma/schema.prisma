generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Vote {
  id     Int        @id @default(autoincrement())
  date   DateTime   @default(now())
  nom    String
  choix  Choix[]
  status VoteStatus @default(INITAL)
}

model Choix {
  id       Int      @id @default(autoincrement())
  date     DateTime @default(now())
  type     Type
  syndicat Sydicat @relation(fields: [syndicatID], references: [id])
  syndicatID Int
  vote     Vote     @relation(fields: [voteId], references: [id])
  voteId   Int

  @@unique([syndicatID, voteId])
}

model Sydicat {
  id    Int     @id @default(autoincrement())
  nom   String  @unique
  rencontre Rencontre[] @relation("Presence")
  choix Choix[]
}

model Rencontre {
  id Int @id @default(autoincrement())
  nom String
  type TypeRencontre
  participant Sydicat[] @relation("Presence")
  sessions Session[]
}

model Session {
  id Int @id @default(autoincrement())
  dateDebut     DateTime @default(now())
  dateFin     DateTime @default(now())
  rencontre Rencontre @relation(fields: [rencontreId], references: [id])
  rencontreId Int
}

enum Type {
  POUR
  CONTRE
  ABSTENTION
  NPPV
}

enum VoteStatus {
  INITAL
  EN_VOTE
  CLOTURE
}

enum TypeRencontre {
  CONGRES
  CF
  BF
  PU
}
