generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Vote {
  id     Int        @id @default(autoincrement())
  date   DateTime   @default(now())
  nom    String
  choix  Choix[]
  status StatusVote @default(INITAL)
}

model Choix {
  id         Int       @id @default(autoincrement())
  date       DateTime  @default(now())
  type       TypeChoix
  syndicat   Syndicat   @relation(fields: [syndicatID], references: [id])
  syndicatID Int
  vote       Vote      @relation(fields: [voteId], references: [id])
  voteId     Int

  @@unique([syndicatID, voteId])
}

model Syndicat {
  id        Int         @id @default(autoincrement())
  nom       String      @unique
  rencontre Rencontre[] @relation("Presence")
  choix     Choix[]
}

model Rencontre {
  id           Int             @id @default(autoincrement())
  dateDebut    DateTime
  dateFin      DateTime
  type         TypeRencontre
  status       StatusRencontre @default(INITIAL)
  participants Syndicat[]       @relation("Presence")
  sessions     Session[]
}

model Session {
  id          Int       @id @default(autoincrement())
  dateDebut   DateTime
  dateFin     DateTime
  rencontre   Rencontre @relation(fields: [rencontreId], references: [id])
  rencontreId Int
}

enum TypeChoix {
  POUR
  CONTRE
  ABSTENTION
  NPPV
}

enum StatusVote {
  INITAL
  EN_VOTE
  CLOTURE
}

enum TypeRencontre {
  CONGRES
  CF
  BF
  PU
}

enum StatusRencontre {
  INITIAL
  DEMARE
  CLOTURE
}
